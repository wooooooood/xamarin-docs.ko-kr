---
title: Android 서비스 만들기
description: 이 가이드에서는 활성 사용자 인터페이스 없이 작업을 수행할 수 있도록 하는 Android 구성 요소인 Xamarin Android 서비스에 대해 설명 합니다. 서비스는 시간이 많이 걸리는 계산, 파일 다운로드, 음악 재생 등 백그라운드에서 수행 되는 작업에 주로 사용 됩니다. 서비스에 적합 한 다양 한 시나리오를 설명 하 고, 장기 실행 백그라운드 작업을 수행 하 고 원격 프로시저 호출에 대 한 인터페이스를 제공 하는 데에도이를 구현 하는 방법을 보여 줍니다.
ms.prod: xamarin
ms.assetid: BA371A59-6F7A-F62A-02FC-28253504ACC9
ms.technology: xamarin-android
author: conceptdev
ms.author: crdun
ms.date: 03/19/2018
ms.openlocfilehash: 042878fa8d30acb55de68f63e3491aacb5dbdfb5
ms.sourcegitcommit: 6b833f44d5fd8dc7ab7f8546e8b7d383e5a989db
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 09/18/2019
ms.locfileid: "71105884"
---
# <a name="creating-android-services"></a>Android 서비스 만들기

_이 가이드에서는 활성 사용자 인터페이스 없이 작업을 수행할 수 있도록 하는 Android 구성 요소인 Xamarin Android 서비스에 대해 설명 합니다. 서비스는 시간이 많이 걸리는 계산, 파일 다운로드, 음악 재생 등 백그라운드에서 수행 되는 작업에 주로 사용 됩니다. 서비스에 적합 한 다양 한 시나리오를 설명 하 고, 장기 실행 백그라운드 작업을 수행 하 고 원격 프로시저 호출에 대 한 인터페이스를 제공 하는 데에도이를 구현 하는 방법을 보여 줍니다._

## <a name="android-services-overview"></a>Android 서비스 개요

모바일 앱은 데스크톱 앱과 다릅니다. 데스크톱과 달리 모바일 장치에는 화면 창, 메모리, 저장소 공간 및 연결된 전원 공급 장치 등의 리소스들이 없습니다. 이러한 제약 조건들은 모바일의 작동 방식을 제한합니다. 예를 들어 모바일 장치에서는 일반적으로 작은 화면에 하나의 앱(즉, 활동)만 표시됩니다. 다른 활동은 백그라운드로 이동되어 일시 중단된 상태가 되며 아무런 작동도 할 수 없습니다. 그러나 Android 응용 프로그램은 백그라운드로 이동된 후에도 작동하는 것이 가능합니다. 

Android 응용 프로그램은 다음 네 가지 기본 구성 요소 중 하나 이상으로 구성 됩니다. _활동_, _브로드캐스트 수신자_, _콘텐츠 공급자_및 _서비스_를 제공 합니다. 활동은 사용자가 응용 프로그램과 상호 작용할 수 있는 UI를 제공 하기 때문에 많은 훌륭한 Android 응용 프로그램의 cornerstone입니다. 그러나 동시 작업 또는 백그라운드 작업을 수행 하는 경우에는 활동을 선택 하는 것이 항상 가장 적합 한 것은 아닙니다.

Android의 백그라운드 작업에 대 한 기본 메커니즘은 _서비스_입니다. Android 서비스는 사용자 인터페이스 없이 일부 작업을 수행 하도록 설계 된 구성 요소입니다. 서비스는 파일을 다운로드 하거나 음악을 재생 하거나 이미지에 필터를 적용할 수 있습니다. Android 응용 프로그램 간의_IPC_(프로세스 간 통신)에도 서비스를 사용할 수 있습니다. 예를 들어 하나의 Android 앱은 다른 앱의 음악 플레이어 서비스를 사용 하거나 앱이 서비스를 통해 다른 앱에 데이터 (예: 개인의 연락처 정보)를 노출할 수 있습니다. 

서비스 및 백그라운드 작업을 수행 하는 기능은 원활한 사용자 인터페이스를 제공 하는 데 매우 중요 합니다. 모든 Android 응용 프로그램에는 활동이 실행 되는 _주 스레드_ ( _UI 스레드_라고도 함)가 있습니다. 장치 응답성을 유지 하기 위해 Android는 초당 60 프레임 속도로 사용자 인터페이스를 업데이트할 수 있어야 합니다. Android 앱이 주 스레드에서 너무 많은 작업을 수행 하는 경우 Android는 프레임을 삭제 합니다. 그러면 UI가 jerky 표시 됩니다 ( _janky_라고도 함). 즉, UI 스레드에서 수행 하는 모든 작업은 두 프레임 사이의 시간 범위 (약 16 밀리초 (60 프레임 마다 1 초))로 완료 되어야 합니다. 

이러한 문제를 해결 하기 위해 개발자는 활동의 스레드를 사용 하 여 UI를 차단 하는 작업을 수행할 수 있습니다. 그러나이로 인해 문제가 발생할 수 있습니다. Android에서 활동의 여러 인스턴스를 삭제 하 고 다시 만들 수 있습니다. 그러나 Android는 스레드를 자동으로 삭제 하지 않으므로 메모리 누수가 발생할 수 있습니다. 이에 대 한 가장 대표적인 예는 [장치가 회전](~/android/app-fundamentals/handling-rotation.md) &ndash; 된 경우 Android에서 활동의 인스턴스를 삭제 하 고 새 활동을 다시 만드는 것입니다.

![장치가 회전 하면 인스턴스 1이 소멸 되 고 인스턴스 2가 만들어집니다.](images/image-01.png)

이는 작업의 첫 번째 &ndash; 인스턴스에서 만든 스레드가 계속 실행 될 수 있는 잠재적 메모리 누수입니다. 스레드에 활동의 첫 번째 인스턴스에 대 한 참조가 있으면 Android에서 개체를 가비지 수집 하지 않습니다. 그러나 활동의 두 번째 인스턴스 (차례로 새 스레드를 만들 수 있음)가 생성 됩니다. 장치를 빠르게 연속 해 서 여러 번 회전 하면 모든 RAM이 고갈 되 고 Android에서 전체 응용 프로그램을 강제로 종료 하 여 메모리를 회수할 수 있습니다.

경험을 위해 수행할 작업이 작업을 수행 해야 하는 경우 해당 작업을 수행 하는 서비스를 만들어야 합니다. 그러나 작업이 작업 컨텍스트에서만 적용 되는 경우 작업을 수행 하는 스레드를 만드는 것이 더 적합할 수 있습니다. 예를 들어 사진 갤러리 앱에 방금 추가 된 사진에 대 한 미리 보기를 만드는 것은 서비스에서 발생할 수 있습니다. 그러나 스레드가 포그라운드에서 작업 하는 동안에만 들릴 수 있는 일부 음악을 재생 하는 것이 더 적합할 수 있습니다.

백그라운드 작업은 다음과 같은 두 가지 광범위 한 분류로 나눌 수 있습니다.

1. **장기 실행 작업** &ndash; 이 작업은 명시적으로 중지 될 때까지 진행 중인 작업입니다. _장기 실행 작업_ 의 예로는 음악을 스트리밍하는 응용 프로그램이 나 센서에서 수집 된 데이터를 모니터링 해야 합니다. 이러한 작업은 응용 프로그램에 표시 되는 사용자 인터페이스가 없더라도 실행 해야 합니다.
2. **정기 작업** (작업이 라고도 함) 정기적으로 작업을 수행 하는 작업은 시간이 비교적 짧고 (몇 초) 일정에 따라 실행 됩니다 (즉, 일주일에 한 번 또는 다음 60 초 동안 한 번만). &ndash; 이에 대 한 예는 인터넷에서 파일을 다운로드 하거나 이미지에 대 한 미리 보기를 생성 하는 것입니다.

Android 서비스에는 다음과 같은 네 가지 유형이 있습니다.

* **바인딩된 서비스** 바인딩된 서비스는 다른 일부 구성 요소 (일반적으로 작업)가 바인딩된 서비스입니다. &ndash; 바인딩된 서비스는 바인딩된 구성 요소와 서비스가 서로 상호 작용할 수 있도록 하는 인터페이스를 제공 합니다. 서비스에 바인딩된 클라이언트가 더 이상 없으면 Android가 서비스를 종료 합니다. 

* **`IntentService`** 는 서비스 만들기 및 사용을 간소화 `Service` 하는 클래스의 특수화 된 하위 클래스입니다. &ndash; _`IntentService`_ 는 개별 자치 호출을 처리 하 는데목적이있습니다.`IntentService` 여러 호출을 `IntentService` 동시에 처리할 수 있는 서비스와 달리은 _작업 큐 프로세서_ &ndash; 작업이 큐에 추가 되 고 단일 작업자 스레드에서 한 `IntentService` 번에 하나씩 각 작업을 처리 하는 것과 유사 합니다. 일반적으로는`IntentService` 활동 또는 조각에 바인딩되지 않습니다. 

* **서비스 시작 됨** 시작 된 서비스는 다른 Android 구성 요소 (예: 작업)에 의해 시작 된 서비스 이며, 서비스에서 중지 하도록 명시적으로 지시할 때까지 백그라운드에서 지속적으로 실행 됩니다. &ndash; 바인딩된 서비스와 달리 시작 된 서비스에는 클라이언트를 직접 바인딩할 수 없습니다. 따라서 필요에 따라 정상적으로 다시 시작할 수 있도록 시작 된 서비스를 설계 하는 것이 중요 합니다.

* **하이브리드 서비스** 하이브리드 서비스는 _시작 된 서비스_ 와 _바인딩된 서비스_의 특징을 포함 하는 서비스입니다. &ndash; 구성 요소가 바인딩될 때 또는 일부 이벤트에 의해 시작 될 수 있는 경우에는 하이브리드 서비스를 시작할 수 있습니다. 클라이언트 구성 요소는 하이브리드 서비스에 바인딩되어 있을 수도 있고 그렇지 않을 수도 있습니다. 하이브리드 서비스는 명시적으로 중지 될 때까지 또는 더 이상 바인딩된 클라이언트가 없을 때까지 계속 실행 됩니다.

사용할 서비스 유형은 응용 프로그램 요구 사항에 따라 달라 집니다. 경험을 위해 `IntentService` 또는 바인딩된 서비스는 Android 응용 프로그램에서 수행 해야 하는 대부분의 작업에 충분 하므로 이러한 두 가지 유형의 서비스 중 하나에 대 한 기본 설정을 지정 해야 합니다. 는 `IntentService` 파일 다운로드와 같은 "일회성" 작업을 수행 하는 데 적합 하며, 바인딩된 서비스는 작업/조각과 자주 상호 작용 해야 하는 경우에 적합 합니다. 

대부분의 서비스는 백그라운드에서 실행 되지만 _포그라운드 서비스_라고 하는 특별 한 하위 범주가 있습니다. 이는 사용자에 대 한 일부 작업 (예: 음악 재생)을 수행 하기 위해 더 높은 우선 순위 (일반 서비스와 비교)를 제공 하는 서비스입니다. 

동일한 장치에서 자체 프로세스의 서비스를 실행할 수도 있습니다 .이는 _원격 서비스_ 또는 _out-of-process 서비스_라고도 합니다 (예를 들어, 이렇게 하려면 만들어야 하지만 응용 프로그램에서 다른 응용 프로그램과 기능을 공유 해야 하는 경우 응용 프로그램의 사용자 환경을 향상 시킬 수 있는 경우에 유용 합니다. 

### <a name="background-execution-limits-in-android-80"></a>Android 8.0의 백그라운드 실행 제한

Android 8.0 (API 레벨 26)부터 Android 응용 프로그램은 더 이상 백그라운드에서 자유롭게 실행할 수 없습니다. 포그라운드에서 응용 프로그램을 시작 하 고 제한 없이 서비스를 실행할 수 있습니다. 응용 프로그램이 백그라운드로 이동 하면 Android에서 서비스를 시작 하 고 사용 하는 데 특정 시간을 부여 합니다. 이 시간이 경과 되 면 앱에서 더 이상 서비스를 시작할 수 없으며 시작 된 서비스가 종료 됩니다. 이 시점에서 앱은 작업을 수행할 수 없습니다. Android는 다음 조건 중 하나가 충족 되는 경우 응용 프로그램을 포그라운드로 고려 합니다.

* 표시 되는 작업 (시작 또는 일시 중지 됨)이 있습니다.
* 앱이 포그라운드 서비스를 시작 했습니다.
* 다른 앱은 포그라운드로 사용 되며 백그라운드에서 달리 구성 요소를 앱에서 사용 하 고 있습니다. 이에 대 한 예는 응용 프로그램 b가 포그라운드에서 제공 하는 서비스에 바인딩되는 응용 프로그램 A가 응용 프로그램 B에서 제공 하는 서비스에 바인딩되는 경우입니다. 응용 프로그램 B는 포그라운드로 고려 되 고 백그라운드에 있도록 Android에서 종료 되지 않습니다.

앱이 백그라운드에 있더라도 Android는 앱의 절전 모드를 해제 하 고 몇 분 동안 이러한 제한을 완화 하므로 앱에서 일부 작업을 수행할 수 있습니다.

* 앱에서 우선 순위가 높은 Firebase 클라우드 메시지를 수신 합니다.
* 앱에서 브로드캐스트를 수신 합니다. 
* 응용 프로그램은 알림에 대 한 `PendingIntent` 응답으로를 수신 하 고 실행 합니다.

기존 Xamarin Android 응용 프로그램은 Android 8.0에서 발생할 수 있는 문제를 방지 하기 위해 백그라운드 작업을 수행 하는 방법을 변경 해야 할 수 있습니다. Android 서비스에 대 한 실질적인 대안은 다음과 같습니다.

* **Android 작업 Scheduler 또는 [Firebase 작업 디스패처](~/android/platform/firebase-job-dispatcher.md) 를 사용 하 여 백그라운드에서 실행할 작업 예약** 이러한 두 라이브러리는 응용 프로그램에서 작업에 대 한 백그라운드 _작업 (불연속_작업 단위)을 구분할 수 있는 프레임 워크를 제공 합니다. &ndash; 그러면 앱이 작업을 실행할 수 있는 시기에 대 한 몇 가지 조건과 함께 운영 체제를 사용 하 여 작업을 예약할 수 있습니다.
* **포그라운드에서 서비스를 시작** 합니다. &ndash; 포그라운드 서비스는 앱이 백그라운드에서 일부 작업을 수행 해야 하 고 사용자가 주기적으로 해당 작업과 상호 작용 해야 하는 경우에 유용 합니다. 포그라운드 서비스는 사용자가 앱이 백그라운드 작업을 실행 하 고 있음을 인식 하 고 작업을 모니터링 하거나 상호 작용 하는 방법을 제공 하도록 영구 알림을 표시 합니다. 이에 대 한 예는 사용자에 게 포드캐스트를 재생 하거나 나중에 사용할 수 있도록 포드캐스트 에피소드를 다운로드 하는 podcasting 앱입니다. 
* **높은 우선 순위 Firebase 클라우드 메시지 사용 (FCM)** &ndash; Android에서 앱에 대해 높은 우선 순위 FCM를 수신 하면 앱은 짧은 시간 동안 백그라운드에서 서비스를 실행할 수 있습니다. 백그라운드에서 응용 프로그램을 폴링하는 백그라운드 서비스를 대신 사용할 수 있는 것이 좋습니다. 
* **앱이 포그라운드로 들어오면 작업 지연** &ndash; 실행 가능한 이전 솔루션이 없는 경우 앱이 포그라운드로 들어올 때 작업을 일시 중지 하 고 작업을 다시 시작 하는 고유한 방법을 앱에서 개발 해야 합니다.

## <a name="related-links"></a>관련 링크

* [Android Oreo 백그라운드 실행 제한](https://www.youtube.com/watch?v=Pumf_4yjTMc)
